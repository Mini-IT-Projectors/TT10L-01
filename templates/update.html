{% extends 'base.html' %}

{% block content %}
<div class="update-group">
    <h1>Update Group</h1>
        <form action="{{ url_for('update_group', group_name=group_to_update.group_name) }}" method="post" >
            {{ form.hidden_tag() }}
            {{ form.group_name.label }}: {{ form.group_name(value=group_to_update.group_name) }}<br><br>
            {{ form.group_leader.label }}: {{ form.group_leader(value=group_to_update.group_leader) }}<br><br>
            {{ form.subject.label }}: {{ form.subject(value=group_to_update._subject) }}<br><br>
            {{ form.lecturer.label }}: {{ form.lecturer(value=group_to_update.lecturer) }}<br><br>
            {{ form.number_of_members.label }}: {{ form.number_of_members(value=group_to_update.number_of_members) }}<br><br>
            
            <div id="member-list">
                {% if group_to_update.number_of_members > 0 %}
                    {% for field in form.member_names %}
                        <div>
                            {{ field.label }} {{ field }}<br><br>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
            {{ form.submit }}
        </form>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <ul>
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
</div>    
        

    <script>
        const numMembersInput = document.getElementById('number_of_members');
        const memberListDiv = document.getElementById('member-list');

        numMembersInput.addEventListener('input', () => {
            const numMembers = parseInt(numMembersInput.value);
            memberListDiv.innerHTML = '';
            if (numMembers > 0) {
                for (let i = 0; i < numMembers; i++) {
                    const fieldContainer = document.createElement('div');
                    const label = document.createElement('label');
                    const input = document.createElement('input');

                    label.textContent = `Member ${i + 1} Name:`;
                    label.htmlFor = `member_name_${i + 1}`;
                    input.type = 'text';
                    input.name = `member_name_${i + 1}`;
                    input.id = `member_name_${i + 1}`;
                    input.required = true;

                    fieldContainer.appendChild(label);
                    fieldContainer.appendChild(input);
                    fieldContainer.appendChild(document.createElement('br'));

                    memberListDiv.appendChild(fieldContainer);
                }
            }
        });
        function Subject() {  
            var mylist = document.getElementById("subject");  
            document.getElementById("favourite").value = mylist.options[mylist.selectedIndex].text;  
            }
        function Lecturer() {  
            var mylist = document.getElementById("subject");  
            document.getElementById("favourite").value = mylist.options[mylist.selectedIndex].text;  
            }
    </script>

{% endblock %}