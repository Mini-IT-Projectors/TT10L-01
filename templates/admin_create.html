{% extends 'base.html' %}

{% block content %}
<div class="nav-container">
    <h2>DearPear</h2> 
    <a href="{{ url_for('home') }}">Sign Out</a>     
    <a href="{{url_for('index_admin')}}">Back</a>
</div>
<div class="container">
    <h1>Create Group</h1>
        <form action="{{ url_for('create_group') }}" method="post" >
            {{ form.hidden_tag() }}
            {{ form.group_name.label }} {{ form.group_name }}<br><br>
            {{ form.group_leader.label }} {{ form.group_leader }}<br><br>
            {{ form.subject.label }} {{ form.subject }}<br><br>
            {{ form.lecturer.label }} {{ form.lecturer }}<br><br>
            {{ form.lecturer_section.label }} {{ form.lecturer_section }}<br><br>
            {{ form.tutorial_section.label }} {{ form.tutorial_section }}<br><br>
            {{ form.number_of_members.label }} {{ form.number_of_members }}<br><br>
            
            <div id="member-list">
                {% if number_of_members > 0 %}
                    {% for field in form.member_names %}
                        {{ field.label }} {{ field(size=20) }}
                        <br><br>
                    {% endfor %}
                {% endif %}
            </div>
            {{ form.submit }}
        </form>
        Doesn't have your subject? <a href="{{ add_subject }}"> Add Here </a> <br>     
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <ul>
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
    
        

    <script>
        const numMembersInput = document.getElementById('number_of_members');
        const memberListDiv = document.getElementById('member-list');

        numMembersInput.addEventListener('input', () => {
            const numMembers = parseInt(numMembersInput.value);
            memberListDiv.innerHTML = '';
            if (numMembers > 0) {
                for (let i = 0; i < numMembers; i++) {
                    const fieldContainer = document.createElement('div');
                    const label = document.createElement('label');
                    const input = document.createElement('input');

                    label.textContent = `Member ${i + 1} Name:`;
                    label.htmlFor = `member_name_${i + 1}`;
                    input.type = 'text';
                    input.name = `member_name_${i + 1}`;
                    input.id = `member_name_${i + 1}`;
                    input.required = true;

                    fieldContainer.appendChild(label);
                    fieldContainer.appendChild(input);
                    fieldContainer.appendChild(document.createElement('br'));

                    memberListDiv.appendChild(fieldContainer);
                }
            }
        });
        function Subject() {  
            var mylist = document.getElementById("subject");  
            document.getElementById("favourite").value = mylist.options[mylist.selectedIndex].text;  
            }
        function Lecturer() {  
            var mylist = document.getElementById("subject");  
            document.getElementById("favourite").value = mylist.options[mylist.selectedIndex].text;  
            }
    </script>
</div>
{% endblock %}