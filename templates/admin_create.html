{% extends 'base.html' %}

{% block content %}
<div class="create-group">
    <h1>Create Group</h1>
        <form action="{{ url_for('create_group') }}" method="post" >
            {{ form.hidden_tag() }}
            <label for="group_name">Group Name:</label>
            <input type="text" id="group_name" name="group_name" required>
            <br><br>
            <label for="group_leader">Group Leader:</label>
            <input type="text" id="group_leader" name="group_leader" required>
            <br><br>
            <label for="subject">Subject:</label>
            <input type="text" id="subject" name="subject" required>
            <br><br>
            <label for="lecturer">Lecturer:</label>
            <input type="text" id="lecturer" name="lecturer" required>
            <br><br>
            <label for="number_of_members">Number of Members:</label>
            <input type="number" id="number_of_members" name="number_of_members" required>
            <br><br>
            <div id="member-list">
                {% if number_of_members > 0 %}
                    {% for field in form.member_names %}
                        {{ field.label }} {{ field(size=20) }}
                        <br><br>
                    {% endfor %}
                {% endif %}
            </div>
            {{ form.submit }}
        </form>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <ul>
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}

    <script>
        const numMembersInput = document.getElementById('number_of_members');
        const memberListDiv = document.getElementById('member-list');

        numMembersInput.addEventListener('input', () => {
            const numMembers = parseInt(numMembersInput.value);
            memberListDiv.innerHTML = '';
            if (numMembers > 0) {
                for (let i = 0; i < numMembers; i++) {
                    const fieldContainer = document.createElement('div');
                    const label = document.createElement('label');
                    const input = document.createElement('input');

                    label.textContent = `Member ${i + 1} Name:`;
                    label.htmlFor = `member_name_${i + 1}`;
                    input.type = 'text';
                    input.name = `member_name_${i + 1}`;
                    input.id = `member_name_${i + 1}`;
                    input.required = true;

                    fieldContainer.appendChild(label);
                    fieldContainer.appendChild(input);
                    fieldContainer.appendChild(document.createElement('br'));

                    memberListDiv.appendChild(fieldContainer);
                }
            }
        });
    </script>
</div>
{% endblock %}